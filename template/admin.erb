<%= render("_html_header.erb") %>

<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script> 
<script>

function create_map(num){
	var map = document.getElementById('map');
	var mapn = 0;
	var walln = 0;

	for(var y=0; y<num; y++) {
		for(var x=0; x<num; x++){
			map.innerHTML += '<input type="checkbox" class="map" id="map['+String(mapn)+']" value="1" checked="checked">';
			mapn++;
			
			if (x!=num-1){
				map.innerHTML += '<input type="checkbox" class="wall" id="wall['+String(walln)+']" value="1">';
				walln++;
			}
		}
		map.innerHTML += '<br/>'

		if (y!=num-1){
			for(var x=0; x<num; x++){
				map.innerHTML += '<input type="checkbox" class="wall" id="wall['+String(walln)+']" value="1">&nbsp;&nbsp;&nbsp;';
				walln++;
			}
			map.innerHTML += '<br/>'
		}
	}
}


function submit_mapdata(){
	var num = document.getElementById('mapnum').value;
	var mapinfo = create_mapinfo();
	var wallinfo = create_wallinfo();

	var maparray = [num,mapinfo,wallinfo];
	var mapjson = JSON.stringify(maparray);
	
	$.ajax({
		url: "",
		type:'POST',
		dataType: 'json',
		data : mapjson
        })
}

function create_mapinfo(){
	var mapinfo = [];
	var maps=document.getElementsByClassName('map')
	
	for(var i=0; i<maps.length; i++){
		if (maps[i].checked===false){
			maps[i].value=0;
		}else{
			maps[i].value=1;
		}
		mapinfo.push(maps[i].value);
	}
	
	return mapinfo;
}

function create_wallinfo(){
	var wallinfo = [];
	var walls=document.getElementsByClassName('wall')
	
	for(var i=0; i<walls.length; i++){
		if (walls[i].checked===false){
			walls[i].value=0;
		}else{
			walls[i].value=1;
		}
		
		wallinfo.push(walls[i].value);
	}
	
	return wallinfo;
}

</script>





<style>
	.map{
		transform:scale(2,2);
	}
</style>



<h2>マップ生成</h2>
大チェック有→マスが存在<br/>
小チェック有→カベが存在<br/>
<select id="mapnum">
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9</option>
<option value="10">10</option>
</select>

<input type="button" value="生成" onclick="create_map(document.getElementById('mapnum').value)">

<div id ="map">
</div>


	
<input type="button" value="送信" onclick="submit_mapdata();">



<%= render("_html_footer.erb") %>
